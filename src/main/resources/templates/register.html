<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cadastro - FindenHub</title>

    <!-- Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css"
    />

    <!-- CSS personalizado -->
    <link rel="stylesheet" th:href="@{/css/register.css}" />
  </head>

  <body>
    <div class="register-container">
      <div class="register-card shadow">
        <div class="text-center mb-4">
          <img
            th:src="@{/img/logo.png}"
            alt="FindenHub"
            class="register-logo"
          />
          <p class="subtitle">Crie já a sua conta!</p>
        </div>

        <div
          th:if="${error}"
          class="alert alert-danger d-flex align-items-center"
        >
          <i class="bi bi-exclamation-circle me-2"></i>
          <span th:text="${error}"></span>
        </div>

        <form
          th:action="@{/register}"
          th:object="${registrationDTO}"
          method="post"
        >
          <!-- Tipo de Conta -->
          <div class="mb-4">
            <label class="form-label fw-bold">Tipo de Conta *</label>
            <div class="row g-3">
              <div class="col-6">
                <label class="user-type-card text-center">
                  <input
                    type="radio"
                    th:field="*{userType}"
                    value="ORGANIZER"
                    class="d-none"
                    required
                  />
                  <i class="bi bi-person-check-fill icon"></i>
                  <h6 class="mt-2 mb-0">Organizador</h6>
                  <p class="small text-muted mb-0">Busco serviços</p>
                </label>
              </div>

              <div class="col-6">
                <label class="user-type-card text-center">
                  <input
                    type="radio"
                    th:field="*{userType}"
                    value="SUPPLIER"
                    class="d-none"
                    required
                  />
                  <i class="bi bi-briefcase-fill icon"></i>
                  <h6 class="mt-2 mb-0">Fornecedor</h6>
                  <p class="small text-muted mb-0">Ofereço serviços</p>
                </label>
              </div>
            </div>
            <div class="text-danger small" th:errors="*{userType}"></div>
          </div>

          <!-- Campos padrão -->
          <div class="mb-3">
            <label class="form-label">Nome Completo *</label>
            <input
              type="text"
              th:field="*{name}"
              class="form-control input-field"
              required
            />
          </div>

          <div class="mb-3">
            <label class="form-label">Email *</label>
            <input
              type="email"
              th:field="*{email}"
              class="form-control input-field"
              required
            />
          </div>

          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">Senha *</label>
              <input
                type="password"
                th:field="*{password}"
                class="form-control input-field"
                minlength="6"
                required
              />
            </div>

            <div class="col-md-6 mb-3">
              <label class="form-label">Confirmar Senha *</label>
              <input
                type="password"
                th:field="*{confirmPassword}"
                class="form-control input-field"
                minlength="6"
                required
              />
            </div>
          </div>

          <div class="mb-3">
            <label class="form-label">Telefone</label>
            <input
              type="tel"
              th:field="*{phone}"
              class="form-control input-field"
              placeholder="(00) 00000-0000"
            />
          </div>

          <div class="row">
            <div class="col-md-4 mb-3">
              <label class="form-label">Estado (UF)</label>
              <select
                id="stateSelect"
                th:field="*{state}"
                class="form-select input-field"
              >
                <option value="">Selecione o estado</option>
              </select>
            </div>

            <div class="col-md-8 mb-3">
              <label class="form-label">Cidade</label>
              <select
                id="citySelect"
                th:field="*{city}"
                class="form-select input-field"
                disabled
              >
                <option value="">Primeiro selecione um estado</option>
              </select>
            </div>
          </div>

          <!-- Campos do fornecedor -->
          <div id="supplierFields" style="display: none">
            <hr />
            <h6 class="section-title mb-3">Informações da Empresa</h6>

            <div class="mb-3">
              <label class="form-label">Nome da Empresa</label>
              <input
                type="text"
                th:field="*{companyName}"
                class="form-control input-field"
              />
            </div>

            <div class="mb-3">
              <label class="form-label">Descrição dos Serviços</label>
              <textarea
                th:field="*{description}"
                class="form-control input-field"
                rows="3"
                placeholder="Conte sobre seus serviços..."
              ></textarea>
            </div>
          </div>

          <button type="submit" class="btn btn-register w-100 py-2 mb-3">
            <i class="bi bi-person-plus me-1"></i> Cadastrar
          </button>

          <div class="text-center">
            <p class="text-muted mb-1">
              Já tem uma conta?
              <a th:href="@{/login}" class="link-register">Entrar</a>
            </p>
            <a th:href="@{/}" class="link-back">← Voltar para Início</a>
          </div>
        </form>
      </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Location Picker API -->
    <script src="/js/location-picker.js"></script>

    <script>
      document.querySelectorAll('input[name="userType"]').forEach((radio) => {
        radio.addEventListener("change", function () {
          const supplierFields = document.getElementById("supplierFields");
          supplierFields.style.display =
            this.value === "SUPPLIER" ? "block" : "none";
          document.querySelectorAll(".user-type-card").forEach((card) => {
            card.classList.remove("active");
          });
          this.closest(".user-type-card").classList.add("active");
        });
      });
    </script>
  </body>
</html>
